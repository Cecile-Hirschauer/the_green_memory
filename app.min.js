document.addEventListener("DOMContentLoaded",()=>{const e=[{icon:"üåø",name:"Foug√®re"},{icon:"üçÑ",name:"Champignon"},{icon:"ü¶ä",name:"Renard"},{icon:"üêù",name:"Abeille"},{icon:"üêû",name:"Coccinelle"},{icon:"üåª",name:"Tournesol"},{icon:"üå≤",name:"Sapin"},{icon:"ü¶ã",name:"Papillon"}],t=document.getElementById("game-board"),n=document.getElementById("moves"),a=document.getElementById("live-feedback"),s=document.getElementById("restart-btn"),o=document.getElementById("game-message");let d=[],i=[],c=0,m=0,l=!1,r=!1;const u=e=>{a.textContent=e},p=(e,t="",n=!0)=>{u(e),n&&(o.textContent=e,o.className="game-message"+(t?` ${t}`:""),o.hidden=!1)},g=()=>{o.hidden=!0,o.textContent="",o.className="game-message"},h=()=>{m=0,c=0,i=[],l=!1,r=!1,n.textContent="0/12 coups",t.innerHTML="",g(),u("Nouvelle partie commenc√©e. √Ä vous de jouer !"),d=(e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e})([...e,...e]),d.forEach((e,n)=>{const a=document.createElement("li"),s=document.createElement("button");s.type="button",s.classList.add("card"),s.dataset.name=e.name,s.dataset.index=n,s.setAttribute("aria-label",`Carte ${n+1}, masqu√©e`),s.innerHTML=`\n                <div class="card-inner">\n                    <span class="card-front" aria-hidden="true">?</span>\n                    <span class="card-back" aria-hidden="true">${e.icon}</span>\n                </div>\n            `,s.addEventListener("click",()=>v(s,e)),a.appendChild(s),t.appendChild(a)})},v=(e,t)=>{r||l||e.classList.contains("flipped")||e.classList.contains("matched")||(b(e,t),2===i.length&&((()=>{m++;const e=12-m;n.textContent=`${m}/12 coups`,5===e?u("Attention, il ne vous reste que 5 coups !"):2===e&&u("Plus que 2 coups !")})(),L()))},b=(e,t)=>{e.classList.add("flipped"),e.setAttribute("aria-label",`Carte ${parseInt(e.dataset.index,10)+1}, ${t.name}`),i.push({element:e,name:t.name})},L=()=>{l=!0;const[t,n]=i;t.name===n.name?C(t,n):E(t,n),m>=12&&c<e.length&&f()},f=()=>{r=!0,setTimeout(()=>{p("Dommage ! Vous avez utilis√© vos 12 coups.","lose"),s.focus()},1200)},C=(t,n)=>{t.element.classList.add("matched"),n.element.classList.add("matched"),c++,p("Paire trouv√©e !","win"),x(),c===e.length&&(r=!0,setTimeout(()=>{p(`Bravo, vous avez gagn√© en ${m} coups !`,"win"),s.focus()},500))},E=(e,t)=>{p("Pas de correspondance, essayez encore.","lose"),setTimeout(()=>{e.element.classList.remove("flipped"),t.element.classList.remove("flipped"),e.element.setAttribute("aria-label",`Carte ${parseInt(e.element.dataset.index,10)+1}, masqu√©e`),t.element.setAttribute("aria-label",`Carte ${parseInt(t.element.dataset.index,10)+1}, masqu√©e`),g(),x()},1e3)},x=()=>{i=[],l=!1};s.addEventListener("click",h),h(),window.addEventListener("load",()=>{if(window.performance){const e=performance.getEntriesByType("resource").reduce((e,t)=>e+(t.transferSize||0),0)+new Blob([document.documentElement.outerHTML]).size,t=document.getElementById("page-weight");t&&e>0&&(t.textContent=(e/1024).toFixed(1)+" Ko")}})});