document.addEventListener("DOMContentLoaded",()=>{const e=[{icon:"üåø",name:"Foug√®re"},{icon:"üçÑ",name:"Champignon"},{icon:"ü¶ä",name:"Renard"},{icon:"üêù",name:"Abeille"},{icon:"üêû",name:"Coccinelle"},{icon:"üåª",name:"Tournesol"},{icon:"üå≤",name:"Sapin"},{icon:"ü¶ã",name:"Papillon"}],t=document.getElementById("game-board"),n=document.getElementById("moves"),a=document.getElementById("live-feedback"),s=document.getElementById("restart-btn"),o=document.getElementById("game-message"),i=12;let d=[],c=[],l=0,m=0,r=!1,u=!1;const p=e=>{a.textContent=e},g=(e,t="",n=!0)=>{p(e),n&&(o.textContent=e,o.className="game-message"+(t?` ${t}`:""),o.hidden=!1)},h=()=>{o.hidden=!0,o.textContent="",o.className="game-message"},v=()=>{m=0,l=0,c=[],r=!1,u=!1,n.textContent="0/12 coups",t.innerHTML="",h(),p("Nouvelle partie commenc√©e. √Ä vous de jouer !"),d=(e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e})([...e,...e]),d.forEach((e,n)=>{const a=document.createElement("li"),s=document.createElement("button");s.type="button",s.classList.add("card"),s.dataset.name=e.name,s.dataset.index=n,s.setAttribute("aria-label",`Carte ${n+1}, masqu√©e`),s.innerHTML=`\n                <div class="card-inner">\n                    <span class="card-front" aria-hidden="true">?</span>\n                    <span class="card-back" aria-hidden="true">${e.icon}</span>\n                </div>\n            `,s.addEventListener("click",()=>b(s,e)),a.appendChild(s),t.appendChild(a)})},b=(e,t)=>{u||r||e.classList.contains("flipped")||e.classList.contains("matched")||(f(e,t),2===c.length&&((()=>{m++;const e=i-m;n.textContent=`${m}/12 coups`,5===e?p("Attention, il ne vous reste que 5 coups !"):3===e?p("Attention, plus que 3 coups !"):1===e&&p("Dernier coup !")})(),L()))},f=(e,t)=>{e.classList.add("flipped"),e.setAttribute("aria-label",`Carte ${parseInt(e.dataset.index,10)+1}, ${t.name}`),c.push({element:e,name:t.name})},L=()=>{r=!0;const[t,n]=c;t.name===n.name?E(t,n):$(t,n),m>=i&&l<e.length&&C()},C=()=>{u=!0,setTimeout(()=>{g("Dommage ! Vous avez utilis√© vos 12 coups.","lose"),s.focus()},1200)},E=(t,n)=>{t.element.classList.add("matched"),n.element.classList.add("matched"),l++,g("Paire trouv√©e !","win"),x(),l===e.length?(u=!0,setTimeout(()=>{g(`Bravo, vous avez gagn√© en ${m} coups !`,"win"),s.focus()},500)):setTimeout(()=>{(()=>{if(e.length-l>0){const t=i-m;p(`${l} paire${l>1?"s":""} trouv√©e${l>1?"s":""} sur ${e.length}. Il vous reste ${t} coup${t>1?"s":""}.`)}})()},1500)},$=(e,t)=>{g("Pas de correspondance, essayez encore.","lose"),setTimeout(()=>{e.element.classList.remove("flipped"),t.element.classList.remove("flipped"),e.element.setAttribute("aria-label",`Carte ${parseInt(e.element.dataset.index,10)+1}, masqu√©e`),t.element.setAttribute("aria-label",`Carte ${parseInt(t.element.dataset.index,10)+1}, masqu√©e`),h(),x()},1e3)},x=()=>{c=[],r=!1};s.addEventListener("click",v),v(),window.addEventListener("load",()=>{if(window.performance){const e=performance.getEntriesByType("resource").reduce((e,t)=>e+(t.transferSize||0),0)+new Blob([document.documentElement.outerHTML]).size,t=document.getElementById("page-weight");t&&e>0&&(t.textContent=(e/1024).toFixed(1)+" Ko")}})});